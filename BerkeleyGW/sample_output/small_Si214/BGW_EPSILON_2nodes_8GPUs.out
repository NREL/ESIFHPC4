 BerkeleyGW version 4.0+git 8511836-dirty by Jacob Clary <jacl0659@ed1.ib0.cm.hpc.nrel.gov> at 2024-03-13 16:03:19 -0600
 Epsilon code, Complex version, run on 02-Nov-2024 at 11:11:12 -0600

                                                                 ..o.          
                                                                .oxxo.         
                                                               .oxxxxo...      
                                                               oxxxxxxo.       
                                                              .oxxxxxxx.       
                                                              .ooooooxxo..     
                                                              .oooooooxo..     
                                                              .oooooxxo...     
                                                       .........oxooo......    
                                                 ............................  
                                             ................................. 
                                          .................................... 
           .          ..oo. ....  .................................oooxxxxxxxo.
     .............oxxxx@ox@@@x@x.....................o...........ooooooooooxx. 
    .o.........oox@x.oo........xxx@@............ooxxxxo..........ooooxxxxxoxo  
    .x........x@xxo...............o@xxo........oxxx@@@xoooooooooooooooxxxo...  
    .o......ox@@o..................oox@o.....ooxxx@xoooxxxxxxxoooooooooooo.... 
    o..ooooo@@xoooo....ooo...........x@o.....ooxxxxo   .oxxxxxxxxxxooooooo.... 
    . .oooo@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@....ooooox.     .oxx@@@@@xxoo........ 
      .ooooxxxxxxxooooooxooooooooooooooxo...oooooxx.        ..ox@xxxoo.........
      .ooooooxxxx@xoooooooooooooxxoooooooooooxxxxx.            .oxxooooooooxxo.
     .oooooxxxxx@@@xxxxxxxxxxxxxxxxxxxxxxxxoxxxxo.                .oxxxxxxxxo. 
   ....oooxxxxx@@@xo..oxxx@@@@@@xxxxoxxoooooooxx.                  .oxxxoo..   
  .....ooxxxx@@xo.       ........    .ooooooooxxo                              
  ..oooxxxx@@@o                       .oooooooxoo.                             
  ....oxooxxxxx.                       .ooo..oooo.                             
  .....o.ooxxxxxo.                     .oooooooxo.                             
 ......ooooxxxxxxo.                     .ooooooxoo..                           
........ooxxxxxxxo..                     .o....oxoo...                         
.......ooooxxxxxxxo.                     ........oooo.                         
.ooooooo..ooxxxxoooo.                    .........ooo...                       
..oxo...ooooxxxoooo..                    .ooo......oooo...                     
  .ooooo....o.                            .oxxxoo....ooo....                   
    .oooooo...                              ...ooooo...ooo..                   
       ...                                     .oo.......                      
                                               ....ooo...                      
                      __              __                                       
 ______              [  |            [  |                 ._____  _          _ 
|_   _               | |  _          | |                /  ___ | |        | |
  | |_) | .---.  _. _.| | / |  .---.  | | .---.  _    _ / /    _|   /  / / 
  |  __'./ /__\[ /`_| '' <  / /__\ | |/ /__\|   | | |   _____  /  / /  
 _| |__| | __. | |   | |`  | ___. | || ___.  / /  .___| |    /  /   
|_______/ .__./[_]  [__|  _] .__./[___].__./    /   .____./    /  /    
                                                  / /                          
                                                 /_/                           
 --------------------------------------------------------------------------------
 Please cite the main BerkeleyGW paper when using results from this calculation:

 Jack Deslippe, Georgy Samsonidze, David A. Strubbe, Manish Jain, Marvin L.
 Cohen, and Steven G. Louie, "BerkeleyGW: A Massively Parallel Computer Package
 for the Calculation of the Quasiparticle and Optical Properties of Materials
 and Nanostructures," Comput. Phys. Commun. 183, 1269 (2012)

 Aditionally, PLEASE CITE ALL PAPERS REPORTED AT THE END OF THIS CALCULATION.
 --------------------------------------------------------------------------------

 Running MPI version (parallel)
 Running with 8 MPI task(s)
 Using OpenMP. Number of threads per MPI task: 16
 Number of threads used for sorting routines: 1

 Compilation flags:
 - Compiler: NVHPC
 - Para. flags: MPI, OMP
 - Math  flags: USESCALAPACK, UNPACKED, USEFFTW3, HDF5
 - Debug flags: 

 Running with verbosity level 1 (default).

 We will start a new calculation from scratch.

 Experimental Features:
  - FFTs Optimization Level: 0
  - Use HDF5 Parallel IO: T

 
 We`ll perform a uniform sampling of the full BZ.
 
 Computing the static inverse dielectric matrix

 We are using matrix communication scheme

 We are using non-blocking cyclic communication scheme

 Using block algorithm over valence bands

 We are communicating via MPI

 We are using no truncation
 Reading header of WFN.h5
 Highest occupied band (unshifted grid) = 428
 Valence max    (unshifted grid) = 6.208185 eV
 Conduction min (unshifted grid) = 6.558149 eV
 Middle energy  (unshifted grid) = 6.383167 eV
 Fermi  energy  (unshifted grid) = 6.383167 eV

 Reading header of WFNq.h5
 Highest occupied band (shifted grid) = 428

 Calculation parameters:
 - Cutoff of the dielectric matrix (Ry): 8.00
 - Total number of bands in the calculation: 6397
 - Number of fully occupied valence bands: 428
 - Number of partially occ. conduction bands: 0
 - Monkhorst-Pack q-grid for epsilon(q): 1 1 1
 
 Running with 2 valence pools
 Number of conduction bands per processor: 1493
 Number of valence bands per processor: 214

 Memory available: 94015.4 MB per PE
 Memory required for execution: 41244.7 MB per PE
 Memory required for vcoul: 0.0 MB per PE

 Valence block alogorithm info
 Max memory allowed per valence block (Gb):    80.00
 Memory for a single valence band (Gb):         0.53
 Number of valence bands per block:             151

 Number of electrons per unit cell (from ifmax) = 856.000000
 Number of electrons per unit cell (from occupations) = 856.000000
 Plasma Frequency = 1.214484 Ry

 Reading using H5FD_MPIO_INDEPENDENT.
 Using communication style:  1
 
 Reading using H5FD_MPIO_INDEPENDENT.
 Using communication style:  1
 
 Initializing eps0mat.h5
 - Screened Coulomb cutoff: 8.000 Ry
 - Total number of bands: 6397
 - Number of q-points: 1

 Scissors parameters:
 - Valence:    es =   0.0000 eV, e0 =   0.0000 eV, edel =   0.0000
 - Conduction: es =   0.0000 eV, e0 =   0.0000 eV, edel =   0.0000

 Q0 and |Q0| =  0.000000  0.000000  0.050000  0.010205

 GPU acceleration is : ENABLED
 
 Algorithms used:
 - mtxel         : OPENACC_ALGO
 - chi_summation : OPENACC_ALGO
 
 You have a slightly shifted q0 vector and a semiconductor.
 So, reading from WFNq.
 Reading header of WFNq.h5
 Highest occupied band (shifted grid) = 428
 Reading using H5FD_MPIO_INDEPENDENT.
 Using communication style:  1
 
 Summary of the WFN files:
 - Number of k-points in WFN: 1
 - Number of k-points in WFNq: 1
 - Number of k-points in the full BZ of WFN: 1

================================================================================
 11:11:25   Dealing with q =  0.000000  0.000000  0.050000                 1 / 1
================================================================================

 This is the special q->0 point.
 Rank of the polarizability matrix (nmtx): 11075
 
 BLACS processor grid:   2 x   4; BLOCKSIZE =   32
 
 Number of k-points in the irreducible BZ(q) (nrk): 1
 
 ========================================================
 == Start Building Polarizability Using:     2 Blocks. ==
 ========================================================
 
 Valence Block Number:     1 of     2 || Pass     1 of     1
 -----------------------------------------------------------
 
 Using GPU support via OpenACC/OMP-Target implementation
 Using batch implementation, batch size:    20
 
 Started calculation of matrix elements with 151 transition(s) at 11:11:28.
 [ 11:11:28 |   0% ] transition   1 / 151.
 [ 11:11:28 |   1% ] transition   3 / 151, remaining: 15 s.
 [ 11:11:29 |  10% ] transition  16 / 151, remaining: 14 s.
 [ 11:11:31 |  20% ] transition  31 / 151, remaining: 13 s.
 [ 11:11:33 |  30% ] transition  46 / 151, remaining: 11 s.
 [ 11:11:34 |  40% ] transition  61 / 151, remaining: 10 s.
 [ 11:11:36 |  50% ] transition  76 / 151, remaining: 8 s.
 [ 11:11:37 |  60% ] transition  91 / 151, remaining: 6 s.
 [ 11:11:39 |  70% ] transition 106 / 151, remaining: 5 s.
 [ 11:11:41 |  79% ] transition 121 / 151, remaining: 3 s.
 [ 11:11:42 |  89% ] transition 136 / 151, remaining: 2 s.
 [ 11:11:44 |  99% ] transition 151 / 151, remaining: 0 s.
 Finished calculation of matrix elements at 11:11:44.
 Elapsed time: 16 s.
 
 CHI summation GPU algorithm offloading all matrix elements to device.
 
 Started building polarizability matrix with 8 processor(s) at 11:11:44.
 [ 11:11:46 |   0% ] processor 1 / 8.
 [ 11:11:47 |  13% ] processor 2 / 8.
 [ 11:11:48 |  25% ] processor 3 / 8, remaining: 6 s.
 [ 11:11:49 |  38% ] processor 4 / 8, remaining: 5 s.
 [ 11:11:50 |  50% ] processor 5 / 8, remaining: 4 s.
 [ 11:11:51 |  63% ] processor 6 / 8, remaining: 3 s.
 [ 11:11:52 |  75% ] processor 7 / 8, remaining: 2 s.
 [ 11:11:53 |  88% ] processor 8 / 8, remaining: 1 s.
 Finished building polarizability matrix at 11:11:54.
 Elapsed time: 10 s.
 
 Done With Block Number:     1
 -----------------------------
 
 
 Valence Block Number:     2 of     2 || Pass     1 of     1
 -----------------------------------------------------------
 
 Using GPU support via OpenACC/OMP-Target implementation
 Using batch implementation, batch size:    20
 
 Started calculation of matrix elements with 151 transition(s) at 11:11:57.
 [ 11:11:57 |   0% ] transition   1 / 151.
 [ 11:11:57 |   1% ] transition   3 / 151, remaining: 17 s.
 [ 11:11:59 |  10% ] transition  16 / 151, remaining: 14 s.
 [ 11:12:00 |  20% ] transition  31 / 151, remaining: 13 s.
 [ 11:12:02 |  30% ] transition  46 / 151, remaining: 11 s.
 [ 11:12:03 |  40% ] transition  61 / 151, remaining: 10 s.
 Finished calculation of matrix elements at 11:12:04.
 Elapsed time: 7 s.
 
 CHI summation GPU algorithm offloading all matrix elements to device.
 
 Started building polarizability matrix with 8 processor(s) at 11:12:04.
 [ 11:12:05 |   0% ] processor 1 / 8.
 [ 11:12:06 |  13% ] processor 2 / 8.
 [ 11:12:07 |  25% ] processor 3 / 8, remaining: 6 s.
 [ 11:12:08 |  38% ] processor 4 / 8, remaining: 5 s.
 [ 11:12:09 |  50% ] processor 5 / 8, remaining: 4 s.
 [ 11:12:10 |  63% ] processor 6 / 8, remaining: 3 s.
 [ 11:12:11 |  75% ] processor 7 / 8, remaining: 2 s.
 [ 11:12:12 |  88% ] processor 8 / 8, remaining: 1 s.
 Finished building polarizability matrix at 11:12:13.
 Elapsed time: 10 s.
 
 Done With Block Number:     2
 -----------------------------
 
 q-pt      1: Head of Epsilon         =     1.777506988066539E+01    6.803578924007741E-17
 q-pt      1: Epsilon(2,2)            =     9.276513200265795E+00    2.000536117779993E-17
 q-pt      1: Head of Epsilon Inverse =     6.227215027609884E-02   -2.441622101297274E-19
 q-pt      1: Epsilon Inverse(2,2)    =     1.196379697682874E-01   -2.848909291306134E-19
 
 For q0 points, you should check the symmetry (eps(G,G') = eps*(-G,-G')) by
 using the eps0sym code. Wavefunction convergence, as well as a finite q-shift
 may cause this property of eps(G,G') to be broken.

 Writing dielectric matrix to file
 Ok


********************************************************************************
*                                                                              *
* Your calculation employed methods and algorithms published in peer-reviewed  *
* papers. Please, cite the following references to give proper credit to their *
*          authors and help support future development of BerkeleyGW.          *
*                                                                              *
********************************************************************************

 J. Deslippe, G. Samsonidze, D. A. Strubbe, M. Jain, M. L. Cohen, and S. G.
 Louie, BerkeleyGW: A Massively Parallel Computer Package for the Calculation
 of the Quasiparticle and Optical Properties of Materials and Nanostructures,
 Computer Physics Communications 183, 1269 (2012).

 M. S. Hybertsen and S. G. Louie, Electron Correlation in Semiconductors and
 Insulators: Band Gaps and Quasiparticle Energies, Phys. Rev. B 34, 5390
 (1986).

 M. D. Ben, C. Yang, Z. Li, F. H. da Jornada, S. G. Louie, and J. Deslippe,
 Accelerating Large-Scale Excited-State GW Calculations on Leadership HPC
 Systems, SC20: International Conference for High Performance Computing,
 Networking, Storage and Analysis (2020).

********************************************************************************

 
 Timing information
 
                                CPU time (s)          WALL time (s)       Number
 Routine                       min        max        min        max     of calls
 -------------------------  ---------  ---------  ---------  ---------  --------
 - Eps (I/O) Comm                0.04       0.16       0.04       0.16         1
 - Eps (I/O) IO                  3.10       3.20       3.10       3.20         1
 - I/O TOTAL                    14.24      14.42      14.24      14.42         8
 - INPUT                         7.62       7.68       7.62       7.68         1
 - INPUT_Q                       3.52       3.70       3.52       3.70         1
 - FULLBZ                        0.00       0.00       0.00       0.00         1
 - GVEC                          0.00       0.00       0.00       0.00         1
 - SUBGRP                        0.00       0.00       0.00       0.00         1
 - IRRBZ                         0.00       0.00       0.00       0.00         1
 - GENWF                         0.41       0.42       0.40       0.42       214
 - MTXEL                        22.51      22.83      22.52      22.83       214
 - RQSTAR                        0.00       0.00       0.00       0.00         2
 - GMAP                          0.00       0.00       0.00       0.00         2
 - EPSINV (TOTAL)                8.81       8.90       8.81       8.90         1
 - CHI SUM (COMM)                0.64       0.74       0.63       0.74        48
 - CHI SUM (TOTAL)              19.75      20.02      19.75      20.02         2
 - GENWF (VAL)                   0.06       0.06       0.04       0.07       214
 - GENWF (COND)                  0.35       0.36       0.35       0.36         2
 - EPSINV (VCOUL)                0.00       0.09       0.00       0.09         1
 - JOB SETUP                     0.00       0.02       0.00       0.02         1
 - Q LOOP SETUP                  0.00       0.00       0.00       0.00         1
 - INIT CUTOFF                   0.00       0.00       0.00       0.00         1
 - INIT SCALAPACK                0.00       0.00       0.00       0.00         1
 - INIT ARRAYS                   3.26       3.32       3.26       3.32         3
 - MTXEL (DENOM)                 0.37       0.38       0.34       0.38    319502
 - MTXEL (FFT)                  22.51      22.83      22.52      22.83       214
 - GENWF (Ekin)                  0.00       0.00       0.00       0.00         4
 - GENWF (Sort)                  0.01       0.01       0.01       0.01         2
 - CHI SUM (zGEMM)              11.47      11.59      11.47      11.59        16
 - CHI SUM (PREP)                3.57       3.59       3.56       3.59        16
 - CHI SUM (ARRAY ALLOC)         0.15       0.15       0.15       0.15        16
 - EPSINV (I/O)                  3.27       3.29       3.27       3.29         1
 - EPSINV (INVERT)               5.19       5.19       5.19       5.19         1
 - CHI SUM (BAR)                 0.00       0.45       0.00       0.46         2
 - FFT MLTPLY                    4.53       4.67       4.58       4.75    319502
 - TOTAL                        69.83      69.84      69.83      69.84         1
 
 Job Done
 
